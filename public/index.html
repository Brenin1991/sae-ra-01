<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAE RA - Realidade Aumentada</title>
    
    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        
        .info {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 5px;
            z-index: 1000;
            font-size: 14px;
        }
        
        .controls {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 5px;
            z-index: 1000;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="info">
        <div>üåü SAE RA</div>
        <div>Realidade Aumentada</div>
    </div>
    
    <div class="controls">
        <div>üëÜ Toque nos objetos para brilho rosa</div>
        <div>üì± Mova o celular para explorar</div>
    </div>

    <!-- V√≠deo da webcam como fundo -->
    <video id="webcam" autoplay muted playsinline style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -1;
    "></video>

    <!-- Cena A-Frame AR -->
    <a-scene 
        vr-mode-ui="enabled: false"
        background="transparent: true"
        cursor="rayOrigin: mouse"
        style="background: transparent; pointer-events: auto;"
        renderer="alpha: true;"
    >
        <!-- Luzes -->
        <a-light type="ambient" color="#404040" intensity="0.6"></a-light>
        <a-light type="directional" position="2 4 5" color="#ffffff" intensity="0.8"></a-light>

        <!-- Objetos 3D -->
        
                 <!-- Esferas flutuantes -->
         <a-sphere 
             position="-1.5 1.5 -2" 
             radius="0.3"
             color="#FF6B6B"
             animation="property: rotation; to: 0 360 0; loop: true; dur: 8000"
             class="clickable"
             cursor-listener
         ></a-sphere>
         
         <a-sphere 
             position="1.5 2 -3" 
             radius="0.25"
             color="#FF6B6B"
             animation="property: rotation; to: 360 0 360; loop: true; dur: 6000"
             animation__float="property: position; to: 1.5 2.5 -3; loop: true; dir: alternate; dur: 3000"
             class="clickable"
             cursor-listener
         ></a-sphere>
         
         <a-sphere 
             position="0 2.5 -4" 
             radius="0.2"
             color="#FF6B6B"
             animation="property: rotation; to: 0 0 360; loop: true; dur: 4000"
             class="clickable"
             cursor-listener
         ></a-sphere>

         <!-- Cubos interativos -->
         <a-box 
             position="-0.8 0.8 -1.5" 
             width="0.4" 
             height="0.4" 
             depth="0.4"
             color="#4ECDC4"
             animation="property: rotation; to: 360 360 0; loop: true; dur: 10000"
             class="clickable"
             cursor-listener
         ></a-box>
         
         <a-box 
             position="1 0.6 -2" 
             width="0.3" 
             height="0.6" 
             depth="0.3"
             color="#FFE66D"
             animation="property: rotation; to: 0 360 360; loop: true; dur: 7000"
             animation__bounce="property: position; to: 1 1 -2; loop: true; dir: alternate; dur: 2000"
             class="clickable"
             cursor-listener
         ></a-box>

         <!-- Torus m√°gico -->
         <a-torus 
             position="0 1 -1.2" 
             color="#9B59B6" 
             radius="0.3" 
             radius-tubular="0.05"
             animation="property: rotation; to: 360 360 360; loop: true; dur: 12000"
             class="clickable"
             cursor-listener
         ></a-torus>

        <!-- C√¢mera -->
        <a-camera 
            position="0 1.6 1"
            look-controls="enabled: true"
            wasd-controls="enabled: true"
        >
            <a-cursor 
                color="#FF69B4"
                animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1 1 1; dur: 150"
                animation__fusing="property: scale; startEvents: fusing; from: 1 1 1; to: 0.1 0.1 0.1; dur: 1500"
                geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                material="color: #FF69B4; shader: flat"
            ></a-cursor>
        </a-camera>
    </a-scene>

    <script>
        // Registrar componente de cursor listener
        AFRAME.registerComponent('cursor-listener', {
            init: function () {
                const el = this.el;
                let isGlowing = false;
                let originalColor = el.getAttribute('color');
                
                // Salvar cor original
                el.setAttribute('data-original-color', originalColor);
                
                // Eventos de clique/toque
                el.addEventListener('click', function () {
                    console.log('Objeto clicado!', el.tagName);
                    
                    if (!isGlowing) {
                        // Ativar brilho rosa
                        el.setAttribute('color', '#FF69B4');
                        el.setAttribute('material', {
                            color: '#FF69B4',
                            emissive: '#FF1493',
                            emissiveIntensity: 0.5
                        });
                        
                        // Anima√ß√£o de pulsa√ß√£o
                        el.setAttribute('animation__glow', {
                            property: 'material.emissiveIntensity',
                            to: 0.8,
                            dur: 1000,
                            loop: true,
                            dir: 'alternate'
                        });
                        
                        // Aumentar tamanho
                        el.setAttribute('animation__scale', {
                            property: 'scale',
                            to: '1.2 1.2 1.2',
                            dur: 300
                        });
                        
                        isGlowing = true;
                        console.log('‚ú® BRILHANDO!');
                        
                    } else {
                        // Voltar ao normal
                        el.setAttribute('color', originalColor);
                        el.setAttribute('material', {
                            color: originalColor,
                            emissive: '#000000',
                            emissiveIntensity: 0
                        });
                        
                        // Remover anima√ß√µes
                        el.removeAttribute('animation__glow');
                        
                        // Voltar tamanho normal
                        el.setAttribute('animation__scale', {
                            property: 'scale',
                            to: '1 1 1',
                            dur: 300
                        });
                        
                        isGlowing = false;
                        console.log('üîÑ Voltou ao normal');
                    }
                });
                
                // Feedback visual no hover
                el.addEventListener('mouseenter', function () {
                    if (!isGlowing) {
                        el.setAttribute('animation__hover', {
                            property: 'scale',
                            to: '1.1 1.1 1.1',
                            dur: 200
                        });
                    }
                });
                
                el.addEventListener('mouseleave', function () {
                    if (!isGlowing) {
                        el.setAttribute('animation__hover', {
                            property: 'scale',
                            to: '1 1 1',
                            dur: 200
                        });
                    }
                });
            }
        });
        
        // Inicializar webcam
        async function initWebcam() {
            try {
                const video = document.getElementById('webcam');
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'environment' // C√¢mera traseira no celular
                    } 
                });
                video.srcObject = stream;
                console.log('üì∑ Webcam inicializada!');
            } catch (error) {
                console.error('‚ùå Erro ao acessar webcam:', error);
                // Fallback: fundo escuro se n√£o conseguir acessar a c√¢mera
                document.querySelector('a-scene').setAttribute('background', 'color: #001133');
            }
        }

        // Inicializar webcam quando a p√°gina carregar
        initWebcam();
        
        // Log de inicializa√ß√£o
        console.log('üöÄ SAE RA - Sistema 3D com Webcam Inicializado!');
    </script>
</body>
</html>