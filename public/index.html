<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>SAE RA - Realidade Aumentada</title>

    <!-- Estilos da aplica√ß√£o -->
    <link rel="stylesheet" href="style.css">

    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://unpkg.com/viewport-units-buggyfill@0.6.2/viewport-units-buggyfill.js"></script>
    
    <!-- html2canvas para captura de tela -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>

<body>    
    <div class="controls" style="display: none;">
        <button id="toggleMode" class="mode-button">üåÖ Modo HDRI</button>
        <button id="clearPecas" class="mode-button" style="background: rgba(255, 0, 0, 0.8);">üóëÔ∏è Limpar Pe√ßas</button>
    </div>

    <div id="main">
        <button id="main-button" class="main-button"></button>
    </div>

    <div id="tutorial">
        <div id="tutorial-content">
            <button id="tutorial-button" class="main-button"></button>
            <button id="narracao-button" class="narracao-button"></button>
            <img id="tutorial-text" src="assets/textures/tutorial-text.png" alt="Tutorial">
        </div>
    </div>

    <div id="ui">
        <img id="camera-icon" class="camera-icon" src="assets/textures/camera-icon.png" alt="Camera">        
        <img id="lupa" class="lupa" src="assets/textures/lupa.png" alt="Lupa">
        
        <!-- Contador de pe√ßas fotografadas -->
        <div id="photo-counter" class="photo-counter">
            <span id="photo-count">0</span> de <span id="total-pieces">0</span> pe√ßas fotografadas
        </div>
    </div>

    <!-- Tela do Quebra-Cabe√ßa -->
    <div id="puzzle-screen" class="puzzle-screen">
        <div class="puzzle-header">
        </div>
        
        <div class="puzzle-container">
            <!-- √Årea de pe√ßas (lado esquerdo) -->
            <div class="pieces-area">
                <div id="puzzle-pieces" class="puzzle-pieces">
                    <!-- Pe√ßas ser√£o criadas dinamicamente -->
                </div>
            </div>
            
            <!-- √Årea de montagem (lado direito) -->
            <div class="assembly-area">
                <div id="puzzle-targets" class="puzzle-targets">
                    <!-- Targets ser√£o criados dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- Tela de Parab√©ns -->
    <div id="congratulations-screen" class="congratulations-screen">
        <img id="parabens-header" src="assets/textures/parabens-header.png" alt="Parab√©ns">
        <img id="narracao-icon-parabens" src="assets/textures/narracao-icon.png" alt="Parab√©ns">
        <img id="parabens-texto-01" src="assets/textures/parabens-texto-01.png" alt="Parab√©ns">
        <img id="btn-next" src="assets/textures/btn-next.png" alt="Parab√©ns">
        <img id="premio-01" src="assets/textures/premio-01.png" alt="Parab√©ns">
        <img id="btn-certificado" src="assets/textures/btn-certificado.png" alt="Parab√©ns">
        <div id="puzzle-resultado-congratulations" class="puzzle-resultado-congratulations"></div>
    </div>

    <!-- Tela de Selfie -->
    <div id="selfie-screen" class="selfie-screen">
        <video id="selfie-camera" autoplay muted playsinline></video>
        <canvas id="selfie-canvas" style="display: none;"></canvas>
        <img id="certificado-top" src="assets/textures/certificado-top.png" alt="Selfie">
        <img id="certificado-bottom" src="assets/textures/certificado-bottom.png" alt="Selfie">
        <img id="camera-icon-selfie" class="camera-icon" src="assets/textures/camera-icon.png" alt="Camera">      
    </div>

    <!-- Efeito de flash da c√¢mera -->
    <div class="camera-flash" id="camera-flash"></div>

    

    <!-- V√≠deo da webcam como fundo -->
    <video id="webcam" autoplay muted playsinline></video>

    <!-- Cena A-Frame AR -->
    <a-scene vr-mode-ui="enabled: false" background="transparent: true" cursor="rayOrigin: mouse"
        renderer="alpha: true; antialias: true; colorManagement: true;"
        environment="preset: none; skyType: atmosphere; horizonColor: #212121; lightPosition: 0.5 0.8 -0.6;">
        <!-- Assets -->
        <a-assets>
            <!-- Fallback: Gradient Sky -->
            <img id="gradientSky"
                src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSI1MTIiIHZpZXdCb3g9IjAgMCAxMDI0IDUxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGRlZnM+CjxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZGllbnQiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMCUiIHkyPSIxMDAlIj4KPHN0b3Agb2Zmc2V0PSIwJSIgc3R5bGU9InN0b3AtY29sb3I6Izg3Q0VFQjtzdG9wLW9wYWNpdHk6MSIgLz4KPHN0b3Agb2Zmc2V0PSI1MCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkY7c3RvcC1vcGFjaXR5OjEiIC8+CjxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6IzQ2ODJCNDtzdG9wLW9wYWNpdHk6MSIgLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8cmVjdCB3aWR0aD0iMTAyNCIgaGVpZ2h0PSI1MTIiIGZpbGw9InVybCgjZ3JhZGllbnQpIi8+Cjwvc3ZnPgo="
                crossorigin="anonymous">
        </a-assets>

        <!-- Sky (Gradient como fallback) -->
        <a-sky src="#gradientSky" rotation="0 0 0" visible="false"></a-sky>

        <!-- Luzes (reduzidas para combinar com HDRI) -->
        <a-light type="ambient" color="#FFFFFF" intensity="0.3"></a-light>
        <a-light type="directional" position="2 4 5" color="#FFFFFF" intensity="0.4"></a-light>

        <!-- Modelo 3D principal -->
        <a-entity id="main-model" gltf-model="" position="0 0 0" rotation="0 0 0" scale="1 1 1">
        </a-entity>

        <!-- Container para objetos interativos -->
        <a-entity id="interactive-objects"></a-entity>

        <!-- As pe√ßas ser√£o criadas dinamicamente quando clicadas -->

        <!-- C√¢mera no centro do cintur√£o -->
        <a-camera position="0 1.6 0" look-controls="enabled: true" wasd-controls="enabled: true">
            <!-- Sistema de detec√ß√£o autom√°tica por dire√ß√£o da c√¢mera -->
            <a-entity 
                id="main-cursor"
                auto-detect=""
            ></a-entity>
        </a-camera>
    </a-scene>

    <!-- Scripts da aplica√ß√£o (carregados por √∫ltimo) -->
    
    <!-- Script principal (carregado primeiro para disponibilizar fun√ß√µes globais) -->
    <script src="script.js"></script>
    
    <!-- M√≥dulos de Tela (carregados depois do script principal) -->
    <script src="js/modules/screens/base-screen.js"></script>
    <script src="js/modules/screens/main-screen.js"></script>
    <script src="js/modules/screens/tutorial-screen.js"></script>
    <script src="js/modules/screens/ui-screen.js"></script>
    <script src="js/modules/screens/puzzle-screen.js"></script>
    <script src="js/modules/screens/congratulations-screen.js"></script>
    <script src="js/modules/screens/selfie-screen.js"></script>
    <script src="js/modules/screen-manager.js"></script>
    
    <!-- M√≥dulos do Puzzle (carregados na ordem correta) -->
    <script src="js/modules/data-manager.js"></script>
    <script src="js/modules/element-manager.js"></script>
    <script src="js/modules/result-manager.js"></script>
    <script src="js/modules/feedback-manager.js"></script>
    <script src="js/modules/drag-drop-manager.js"></script>
    <script src="js/modules/puzzle-game-manager.js"></script>
    <script src="puzzle-manager.js"></script>
</body>

</html>